
from sage.all_cmdline import *   # import sage library

_sage_const_1p582865871833962350672487559906539350957045416218604029623801809371663187120135885773063504257759077083569730916957342287410122618714508676572477981771741910358410930757789936535603770759077822533963997825559582891735692273934906638208523910403941880272794583604745417406979461840307679511885662587 = RealNumber('1.582865871833962350672487559906539350957045416218604029623801809371663187120135885773063504257759077083569730916957342287410122618714508676572477981771741910358410930757789936535603770759077822533963997825559582891735692273934906638208523910403941880272794583604745417406979461840307679511885662587'); _sage_const_2p622057554292119810464839589891119413682754951431623162816821703800790587070414250230295532961429093446135752671783218055608956901393935694701119434775235840422641497164906951936899979932146072383121390810206221897429600856554539772305369549710288888325526487021329012097540833128568511729752229214 = RealNumber('2.622057554292119810464839589891119413682754951431623162816821703800790587070414250230295532961429093446135752671783218055608956901393935694701119434775235840422641497164906951936899979932146072383121390810206221897429600856554539772305369549710288888325526487021329012097540833128568511729752229214'); _sage_const_0p8476433448954187054724265679077740799227260890294155582018935938514611938418638905500305109792958619920222495821341257165266698620566820476342332700555752487047762519584784225717894517675125559580182003624145689288072916543718840670420827333241007797418444791851958301131513893479094664507855619210 = RealNumber('0.8476433448954187054724265679077740799227260890294155582018935938514611938418638905500305109792958619920222495821341257165266698620566820476342332700555752487047762519584784225717894517675125559580182003624145689288072916543718840670420827333241007797418444791851958301131513893479094664507855619210'); _sage_const_10 = Integer(10); _sage_const_200 = Integer(200); _sage_const_1 = Integer(1); _sage_const_0 = Integer(0); _sage_const_2 = Integer(2)
from Crypto.Util.number import long_to_bytes
from Crypto.Cipher import AES
s= _sage_const_1p582865871833962350672487559906539350957045416218604029623801809371663187120135885773063504257759077083569730916957342287410122618714508676572477981771741910358410930757789936535603770759077822533963997825559582891735692273934906638208523910403941880272794583604745417406979461840307679511885662587 
mod= _sage_const_2p622057554292119810464839589891119413682754951431623162816821703800790587070414250230295532961429093446135752671783218055608956901393935694701119434775235840422641497164906951936899979932146072383121390810206221897429600856554539772305369549710288888325526487021329012097540833128568511729752229214 
new_s= -_sage_const_0p8476433448954187054724265679077740799227260890294155582018935938514611938418638905500305109792958619920222495821341257165266698620566820476342332700555752487047762519584784225717894517675125559580182003624145689288072916543718840670420827333241007797418444791851958301131513893479094664507855619210 
ciphertext="a756399aaa85cb6de7d2541eb35d64ae00491b9d84bdc655f508384a4d1a92da44320f4d76f7a931ca93cb58a7d384360e826fb8c02c03a329d2c313589f19ef"
s=int(s*_sage_const_10 **(_sage_const_200 ))
new_s=int(new_s*_sage_const_10 **(_sage_const_200 ))
mod=int(mod*_sage_const_10 **(_sage_const_200 ))
m=Matrix([[new_s,_sage_const_1 ,_sage_const_0 ,_sage_const_0 ],[s,_sage_const_0 ,_sage_const_1 ,_sage_const_0 ],[mod,_sage_const_0 ,_sage_const_0 ,_sage_const_1 ]])
m=m.LLL()
n=-m[_sage_const_0 ][_sage_const_2 ]
key=long_to_bytes(n)
print(AES.new(key,AES.MODE_ECB).decrypt(bytes.fromhex(ciphertext)))



