from Crypto.Util.number import long_to_bytes

p = 177570430264404042586947209415361175829662877465021738163452003044204801236884005980142784114098378718171232421758262680024168974955507208327903586791589504974287563947107311706980541752128561476280897335081377540882450802053121704994636737618193754484639531123445136371629051163053932580571940280678765406507
hint = 111835764538968835283671465944316573442933510238606935593825235958809709981307851841392212790079210442271736305104653249935653746189422754282042111667903170916672655913492221169563628845786374370984595021502163203501215307272819616639858055813062468690363664768682360975293577533019188775265576784532652545007
na = 104981549674640644710992474738787514783337845875575563533951639895157064142653635970609841945882662523822487157742119169548931058760287290537492441439040492987996385630373665921686320130578366015520701550154901525673469752599580112650397204330105153031549038749321939161662923292983771755764077247697955009412
nb = 109154208308033964429236776917605830951528167782331813507759325269197362192975790464704498454557816541238437329135905792569697324454093305196426258235908980564678163715316099304439146745372773270617547309405441456232624598379216927702509871384679259030341851365131366297678664733271909254946770955376189773174
A= 136407737305511360356397851151387434747104130517942844746307421591300142246172197908094415745159427162154420196514774405243398839327050657296253147517687400701852380101057349604958670296473446404895687124842088949969419486055881611144671929238142825450181746276221000200846658169851653919504352250739069860730
B= 26467203262894711969159457169326125007000815712021405657352754729857627693311672965448787149024723113418146398326650495992712486220869311766554396353531102926524277200284073965641737905200427505698807999274743916487363108331073718034682818342814978156028844309220276666373635341609073539725142950450555754476
# Reverse the encryption process to recover the original flag
shared_secret = pow(pow(A, nb, p), na, p)
inverse_shared_secret = pow(shared_secret, -1, p)
m = (hint * inverse_shared_secret) % p
flag = long_to_bytes(m)

# Handle non-decodable bytes
try:
    flag_decoded = flag.decode('utf-8')
except UnicodeDecodeError:
    flag_decoded = flag.decode('latin-1')

print("Flag:", flag_decoded)
