<code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br>$action&nbsp;</span><span style="color: #007700;">=&nbsp;</span><span style="color: #0000BB;">$_POST</span><span style="color: #007700;">[</span><span style="color: #DD0000;">"a"</span><span style="color: #007700;">];<br></span><span style="color: #0000BB;">$host &nbsp; </span><span style="color: #007700;">=&nbsp;</span><span style="color: #0000BB;">$_POST</span><span style="color: #007700;">[</span><span style="color: #DD0000;">"h"</span><span style="color: #007700;">];<br><br></span><span style="color: #0000BB;">$cmd&nbsp;</span><span style="color: #007700;">=&nbsp;</span><span style="color: #DD0000;">""</span><span style="color: #007700;">;<br>switch&nbsp;(</span><span style="color: #0000BB;">$action</span><span style="color: #007700;">)&nbsp;{<br>&nbsp;&nbsp; &nbsp;case&nbsp;</span><span style="color: #DD0000;">"ping"</span><span style="color: #007700;">:<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #0000BB;">$cmd&nbsp;</span><span style="color: #007700;">=&nbsp;</span><span style="color: #DD0000;">"ping&nbsp;"&nbsp;</span><span style="color: #007700;">.&nbsp;</span><span style="color: #0000BB;">$host&nbsp;</span><span style="color: #007700;">.&nbsp;</span><span style="color: #DD0000;">"&nbsp;-c&nbsp;2&nbsp;-W&nbsp;1"</span><span style="color: #007700;">;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;break;<br>&nbsp;&nbsp; &nbsp;case&nbsp;</span><span style="color: #DD0000;">"dig"</span><span style="color: #007700;">:<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #0000BB;">$cmd&nbsp;</span><span style="color: #007700;">=&nbsp;</span><span style="color: #DD0000;">"dig&nbsp;+nocmd&nbsp;"&nbsp;</span><span style="color: #007700;">.&nbsp;</span><span style="color: #0000BB;">$host&nbsp;</span><span style="color: #007700;">.&nbsp;</span><span style="color: #DD0000;">"&nbsp;ANY&nbsp;+multiline&nbsp;+noall&nbsp;+answer&nbsp;@8.8.8.8&nbsp;&amp;2&gt;1"</span><span style="color: #007700;">;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;break;<br>&nbsp;&nbsp; &nbsp;case&nbsp;</span><span style="color: #DD0000;">"whodis"</span><span style="color: #007700;">:<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #0000BB;">$cmd&nbsp;</span><span style="color: #007700;">=&nbsp;</span><span style="color: #DD0000;">"whois&nbsp;"&nbsp;</span><span style="color: #007700;">.&nbsp;</span><span style="color: #0000BB;">$host</span><span style="color: #007700;">;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;break;<br>&nbsp;&nbsp; &nbsp;case&nbsp;</span><span style="color: #DD0000;">"ns"</span><span style="color: #007700;">:<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: #0000BB;">$cmd&nbsp;</span><span style="color: #007700;">=&nbsp;</span><span style="color: #DD0000;">"nslookup&nbsp;"&nbsp;</span><span style="color: #007700;">.&nbsp;</span><span style="color: #0000BB;">$host</span><span style="color: #007700;">;<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;break;<br>&nbsp;&nbsp; &nbsp;default:<br>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;die(</span><span style="color: #DD0000;">"Invalid&nbsp;request\n"</span><span style="color: #007700;">);<br>}<br><br></span><span style="color: #0000BB;">$output&nbsp;</span><span style="color: #007700;">=&nbsp;</span><span style="color: #0000BB;">shell_exec</span><span style="color: #007700;">(</span><span style="color: #0000BB;">$cmd</span><span style="color: #007700;">);<br>die(</span><span style="color: #0000BB;">$output&nbsp;</span><span style="color: #007700;">.&nbsp;</span><span style="color: #DD0000;">"\n"</span><span style="color: #007700;">);<br></span><span style="color: #0000BB;">?&gt;<br></span>
</span>
</code>